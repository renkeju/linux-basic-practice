======================
1.3 安装 CentOS
======================

从安装介质入手
-------------------

.iso是电脑上光盘镜像", "CD Mirror"的存储格式之一，因为其是根据ISO-9660有关CD-ROM文件系统标准存储的文件，所以通常在电脑中以后缀.iso命名，俗称iso镜像文件。它形式上只有一个文件，可以真实反映光盘的内容，可由刻录软件或者镜像文件制作工具创建。.iso和我们熟识的.zip压缩包非常类似，在windows环境下，我们可以将计算机中的文件、文件夹通过WinRAR压缩成为.zip压缩包，而刻录软件", "如UItraISO"则可以将光盘中的文件、文件夹“压缩“成为.iso文件", "用提取也许更为合适，因为前后两者大小几乎相同"。尽管.iso文件也可以通过WinRAR进行解压，但是对于的特殊.iso文件这样的操作会使得其失去其特殊功能。像系统光盘刻录成的.iso文件", "如Windows安装光盘"，通过WinRAR解压则会使其失去安装系统的功能，普通数据类文件“压缩“成的.iso文件，如音频，视频，文档，通过WinRAR解压并没有影响。

常见的刻录软件有 UltraISO 软碟通、PowerISO 和 balenaEtcher 等。UltraISO 与 PowerISO 可以免费试用，但是试用更高级的功能需要付费，而 balenaEtcher 则是开源软件，可以免费试用。所以这里我们演示如何通过 balenaEtcher 制作一个 CentOS 系统引导安装U盘。

1. 首先打开网址 https://www.balena.io/etcher/：

  .. image:: /_images/Chapter_1/balenaEtcher_website.png
    :scale: 80%
    :align: center

2. 选择当前操作系统相关下载，下面以 Windows 操作系统举例：

  .. image:: /_images/Chapter_1/balenaEtcher_platform.png
    :align: center

  下载完成后安装 balenaEtcher。

  .. note:: Installer 为安装版本，在Windows系统中有注册表注入，Portable 为免安装便携版本。请根据自己的需求进行选择下载。

3. 进行安装：

  点击“我同意”进行安装。

  .. image:: /_images/Chapter_1/balenaEtcher_install.PNG
    :align: center

  安装完成后，点击桌面图标“balenaEtcher”可以看到如下界面：

  .. image:: /_images/Chapter_1/balenaEtcher_window.PNG
    :scale: 80%
    :align: center

当我们安装完成刻录工具之后，需要准备一个U盘，并且下载好需要刻录的.iso文件。我们可以去CentOS 官方网站获取 .iso 文件，也可以通过国内镜像站获取 .iso 文件。这里我提供国内清华大学镜像站 CentOS 8 1905 下载链接 https://mirrors.tuna.tsinghua.edu.cn/centos/8/isos/x86_64/。点击以 .iso 后缀结尾的文件链接即可下载到本地。

4. 进行刻录

  点击 “Select image” 选择需要刻录的 .iso 文件：

  .. image:: /_images/Chapter_1/balenaEtcher_window.PNG
    :scale: 80%
    :align: center

  点击 “Select target” 选择存储介质：

  .. image:: /_images/Chapter_1/balebaEtcher_select_target.PNG
    :scale: 80%
    :align: center

  点击 “Flash！” 进行刻录：

  .. image:: /_images/Chapter_1/balenaEtcher_flash_1.PNG
    :scale: 80%
    :align: center

  .. image:: /_images/Chapter_1/balenaEtcher_flash_2.PNG
    :scale: 80%
    :align: center

  .. image:: /_images/Chapter_1/balenaEtcher_flash_3.PNG
    :scale: 80%
    :align: center

  .. image:: /_images/Chapter_1/balenaEtcher_flash_4.PNG
    :scale: 80%
    :align: center

  .. image:: /_images/Chapter_1/balenaEtcher_flash_5.PNG
    :scale: 80%
    :align: center

至此，我们就制作完成了一个 CentOS 系统引导安装U盘。

系统安装过程
----------------

将我们制作好的 CentOS 系统引导安装U盘插入服务器、台式机或笔记本，按下电源键后，请根据下表提供的常用快捷键进入 BIOS：

.. csv-table:: 品牌台式机以及笔记本电脑进入BIOS按键
   :header: "品牌", "按键"
   :widths: 30, 50

    "ibm/thinkpad", "冷开机按f1，部分新型号可以在重新启动时启动按f1"
    "惠普 HP", "启动和重新启动时按f2或者F10"
    "索尼 Sony", "启动和重新启动时按f2"
    "戴尔 Dell", "启动和重新启动时按f2"
    "宏碁 Acer", "启动和重新启动时按f2"
    "东芝 Toshiba", "冷开机时按esc然后按f1"
    "富士通 fujitsu", "启动和重新启动时按f2"
    "三星 Samsung", "启动和重新时按f2"
    "联想 Lenovo", "启动时按F2或Fn+F2，部分机型需关机时按Novo恢复键"
    "华硕 Asus", "启动时按F2"

进入BIOS后，我们需要更改启动引导顺序，下面通过最常见的 Phoenix BIOS 举例：

.. image:: /_images/Chapter_1/BIOS/BIOS_view.png
  :align: center

看到BIOS界面后使用键盘的“←→”左右键切换到 Boot 选项：

.. image:: /_images/Chapter_1/BIOS/BIOS_Boot.png
  :align: center

然后使用“+-”加减键更改启动顺序，我们应该将U盘放置在第一位。确认后按 F10 快捷键保存并退出，之后进入 CentOS 安装界面。

.. image:: /_images/Chapter_1/CentOS/CentOS_8_Install_select.png
  :align: center

在安装界面可以看到三个界面，使用键盘“↑↓”上下键可以切换，我们选择“Install CentOS Linux 8.0.1905”：

.. image:: /_images/Chapter_1/CentOS/select_Install_CentOS_8.0.1905.png
  :align: center

之后将会进入系统引导：

.. image:: /_images/Chapter_1/CentOS/system_boot.png
  :align: center

引导完成后可以看到语言选择界面，这里选择简体中文进行后续的安装：

.. image:: /_images/Chapter_1/CentOS/choois_language.png
  :align: center

点击继续后进入安装信息摘要，在这个界面我们可以对 CentOS 系统安装指定配置：

.. image:: /_images/Chapter_1/CentOS/install_summary.png
  :align: center

在“可视化”这一栏中，我们可以看到“键盘”、“语言支持”和“时间和日期”，刚才我们已经选择了语言为简体中文，所以这里我们只需修改时区即可，时区建议修改为 “亚洲/上海”：

.. image:: /_images/Chapter_1/CentOS/change_timezone.png
  :align: center

时区配置完成后，点击完成按钮，退回到安装信息摘要界面，在“软件”这一栏中，我们可以看到“安装源”和“软件选择”，安装源默认为“本地安装”，所以不需要进行修改。在“软件选择”的选项中，默认安装为“带有 GUI 的服务器”，也就是带有图形界面。建议更改为“最小化安装”：

.. image:: /_images/Chapter_1/CentOS/GUI_server.png
  :align: center

.. image:: /_images/Chapter_1/CentOS/mini_install.png
  :align: center

“软件选择”配置完成后，点击完成按钮，退回到安装信息摘要界面，在“系统”这一栏中，我们需要修改“安装目的地”和“网络和主机名”。先来修改“安装目的地”:

.. image:: /_images/Chapter_1/CentOS/install_disk_target.png
  :align: center

如果显示的磁盘空间为空闲，你并不需要做更多的设置。但是如果你的磁盘中已经安装过其他的操作系统或是部分空间被占用，则需要进行一些调整。如下，这个主机中的磁盘已经安装过了 CentOS 7 系统，没有多余的空闲空间，此时需要释放磁盘空间以便安装 CentOS 8。

.. image:: /_images/Chapter_1/CentOS/no_free_disk.png
  :align: center

更改“存储配置”为“自定义”，然后点击“完成”按钮，进入磁盘空间手动分区配置界面：

.. image:: /_images/Chapter_1/CentOS/change_storage_configuration.png
  :align: center

.. image:: /_images/Chapter_1/CentOS/manual_partition.png
  :align: center

点击 “**CentOS Linux 7.7.1908 for x86_64**”，查看已有分区：

.. image:: /_images/Chapter_1/CentOS/view_existing_partitions.png
  :align: center

选则“/”根分区，并点击下方“-”号，删除已有分区,如果你也想同时删除“/”根分区下的所有其他分区，在“删除仅由 CentOS Linux 7.7.1908 for x86_64 使用的文件系统”前勾选后点击“删除”按钮即可：

.. image:: /_images/Chapter_1/CentOS/delete_existing_partitions.png
  :align: center

此时已经删除了所有分区，我们点击“点击这里自动创建它们”可以创建新的分区供安装 CentOS 8 系统使用：

.. image:: /_images/Chapter_1/CentOS/all_free_disk.png
  :align: center

.. image:: /_images/Chapter_1/CentOS/new_partitions.png

注意！之前的所有配置此时还并未生效，但当我们点击“完成”按钮后就会列出就会执行删除旧的分区并生成新的分区的更改摘要，最后点击“接受更改”按钮执行操作：

.. image:: /_images/Chapter_1/CentOS/partitions_summary_of_change.png

.. attention:: 删除已有操作系统的分区，原有数据不可恢复。如有重要数据，请确认备份后再进行操作！

“安装目的地”配置完成后我们返回到“安装信息摘要”界面，继续配置“网络和主机名”：

.. image:: /_images/Chapter_1/CentOS/view_network_and_hostname.png

在“网络和主机名”的界面可以看到设备的物理网卡列表与主机名称，物理网卡默认是关闭的，主机名称默认为“**localhost.localdomain**”。我们点击网卡右侧按钮启动网卡：

.. image:: /_images/Chapter_1/CentOS/enable_nic.png

点击“完成”按钮退回到“安装信息摘要”界面，检查所有配置项：

.. image:: /_images/Chapter_1/CentOS/all_configuration_is_done.png

检查后确认没有问题，点击“开始安装”按钮进行系统安装：

.. image:: /_images/Chapter_1/CentOS/configuration_and_install.png

在系统按照刚才的配置进行安装的同时，你需要对系统设置登录密码，密码有“根密码”与“创建用户”。设置“根密码”就是对 *root* 用户设置密码。

.. image:: /_images/Chapter_1/CentOS/root_password.png

.. note:: 根密码就相当与在 Windows 主机中对默认最该权限用户 “Administrator” 密码。根用户 root 具有系统最高权限，建议设置的密码具有一定的复杂度。

用户密码可以在系统安装完成后再进行设定，也可以此时设定：

.. image:: /_images/Chapter_1/CentOS/setup_root_password.png

从系统安全角度来讲，建议尽量避免使用 *root* 用户登录设备：

.. image:: /_images/Chapter_1/CentOS/setup_user_and_password.png

.. note:: 为了方便管理，我们也可以将新建的用户提权为管理员，在登录系统后，使用 ``sudo`` 命令此用户权限等同与 *root* 用户。

当进度条完成后，我们点击“重启系统”按钮即可进入CentOS系统：

.. image:: /_images/Chapter_1/CentOS/loading.png

.. image:: /_images/Chapter_1/CentOS/reboot.png


登录
--------

此时我们已经完成了 CentOS 8 Linux 系统的安装，下面我们登录 CentOS Linux 系统使用。首先我们会看到 CentOS Linux 的启动选项：

.. image:: /_images/Chapter_1/CentOS/startup_item.png

有时当我们更新了系统内核之后，系统中会有多个内核。我们在启动时指定内核版本启动系统。在上面示例中第一二个选项都是选择从那个Linux内核启动系统，第三个选项是系统设置，类似与Windows的维护模式。一般默认为最上方的选项进入系统，在系统启动后，我们可以看到一个黑色的窗口中有白色的字符：

.. image:: /_images/Chapter_1/CentOS/tty.png

按照我们安装系统时指定的用户名和密码登录：

.. image:: /_images/Chapter_1/CentOS/login.png

.. attention:: 在 Linux 终端中登录密码并不会打印出“*”星号。这里和 Windows 登录有所不同。